#include<stdio.h>
#include<stdlib.h>
#include<time.h>

//sparse matrix edge_index 2*9104
#define Edge_Number  505
int edge_row[Edge_Number]={1619, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1620, 1621, 1621, 1622, 1622, 1622, 1623, 1623, 1624, 1624, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1625, 1626, 1626, 1627, 1627, 1628, 1629, 1629, 1630, 1630, 1630, 1631, 1633, 1634, 1634, 1634, 1635, 1635, 1636, 1637, 1638, 1639, 1640, 1640, 1640, 1641, 1642, 1643, 1644, 1644, 1644, 1644, 1644, 1644, 1644, 1644, 1644, 1644, 1644, 1644, 1645, 1646, 1647, 1647, 1647, 1647, 1647, 1647, 1648, 1648, 1649, 1650, 1650, 1650, 1651, 1651, 1651, 1652, 1653, 1654, 1655, 1655, 1655, 1655, 1655, 1655, 1655, 1656, 1657, 1658, 1659, 1660, 1660, 1661, 1662, 1662, 1663, 1663, 1663, 1664, 1664, 1665, 1665, 1665, 1665, 1665, 1666, 1666, 1666, 1666, 1666, 1666, 1666, 1666, 1666, 1666, 1666, 1666, 1667, 1667, 1668, 1668, 1668, 1668, 1668, 1669, 1669, 1670, 1670, 1670, 1671, 1671, 1672, 1672, 1672, 1672, 1673, 1674, 1675, 1675, 1676, 1676, 1676, 1676, 1676, 1677, 1677, 1677, 1677, 1678, 1678, 1678, 1679, 1680, 1681, 1682, 1682, 1683, 1683, 1683, 1683, 1683, 1683, 1683, 1684, 1684, 1685, 1686, 1687, 1687, 1687, 1687, 1687, 1688, 1689, 1690, 1691, 1692, 1693, 1694, 1694, 1695, 1695, 1696, 1696, 1697, 1698, 1698, 1698, 1698, 1699, 1699, 1699, 1700, 1701, 1701, 1702, 1702, 1702, 1703, 1704, 1704, 1704, 1704, 1704, 1704, 1705, 1705, 1705, 1705, 1705, 1706, 1706, 1707, 1707, 1707, 1707, 1708, 1708, 1708, 1708, 1708, 1708, 1708, 1708, 1708, 1708, 1708, 1708, 1708, 1708, 1708, 1709, 1709, 1709, 1710, 1710, 1710, 1710, 1711, 1711, 1712, 1713, 1714, 1714, 1715, 1716, 1717, 1717, 1718, 1718, 1718, 1718, 1718, 1718, 1718, 1719, 1720, 1720, 1721, 1721, 1721, 1721, 1721, 1721, 1722, 1723, 1724, 1724, 1724, 1724, 1724, 1724, 1724, 1724, 1725, 1725, 1725, 1725, 1725, 1726, 1726, 1726, 1727, 1728, 1728, 1729, 1729, 1730, 1730, 1731, 1731, 1731, 1731, 1731, 1731, 1731, 1732, 1733, 1733, 1733, 1733, 1734, 1734, 1735, 1736, 1736, 1736, 1736, 1736, 1736, 1737, 1737, 1738, 1738, 1739, 1740, 1740, 1741, 1742, 1743, 1744, 1745, 1746, 1746, 1746, 1746, 1747, 1747, 1748, 1749, 1750, 1750, 1751, 1751, 1752, 1753, 1754, 1755, 1755, 1756, 1757, 1757, 1757, 1758, 1758, 1758, 1758, 1758, 1758, 1758, 1759, 1759, 1759, 1759, 1759, 1759, 1759, 1759, 1759, 1760, 1760, 1760, 1760, 1761, 1761, 1761, 1762, 1762, 1763, 1764, 1764, 1766, 1766, 1767, 1767, 1767, 1767, 1768, 1768, 1768, 1768, 1768, 1769, 1769, 1770, 1770, 1770, 1771, 1771, 1772, 1772, 1772, 1772, 1772, 1773, 1774, 1774, 1775, 1776, 1777, 1778, 1778, 1779, 1779, 1779, 1779, 1780, 1781, 1782, 1782, 1782, 1783, 1783, 1784, 1784, 1785, 1786, 1787, 1788, 1789, 1790, 1791, 1791, 1791, 1792, 1793, 1794, 1795, 1795, 1795, 1796, 1797, 1798, 1799, 1800, 1801, 1801, 1802, 1802, 1802, 1802, 1803, 1804, 1805, 1805, 1806, 1806, 1807, 1808, 1808, 1808, 1808, 1808, 1809, 1809, 1809, 1809, 1810, 1810, 1810, 1811, 1811, 1811};
int edge_col[Edge_Number]={2323, 62, 194, 304, 429, 494, 541, 637, 808, 1027, 1087, 1326, 1771, 1817, 1826, 2245, 2335, 2440, 2562, 2631, 2636, 2721, 2977, 3026, 530, 856, 12, 150, 224, 1627, 1938, 3037, 3038, 31, 43, 154, 414, 661, 875, 968, 1019, 1070, 1097, 1251, 1429, 1453, 1492, 1587, 1609, 1666, 1759, 1821, 1875, 1965, 2224, 2429, 2621, 2632, 2638, 2680, 2681, 2886, 1897, 2856, 1623, 1938, 2155, 1220, 2473, 451, 1422, 2621, 133, 2622, 2208, 2861, 2866, 1112, 1386, 1876, 259, 951, 102, 1580, 1923, 2183, 530, 2474, 3325, 453, 492, 1012, 1034, 1112, 1214, 1351, 1422, 2021, 2247, 2404, 2782, 980, 1898, 147, 428, 755, 773, 1112, 2626, 1288, 2266, 1805, 120, 337, 2888, 487, 734, 3304, 2733, 1714, 2312, 216, 434, 650, 2000, 2331, 2506, 3209, 455, 2868, 1422, 1120, 405, 582, 2272, 1092, 3185, 346, 1422, 2396, 3092, 3297, 468, 872, 1591, 1670, 2633, 152, 414, 847, 1130, 1131, 1230, 1399, 1625, 1989, 2110, 2427, 2435, 2603, 3286, 154, 894, 1008, 1415, 2399, 248, 297, 10, 1665, 3256, 792, 2400, 877, 1155, 1971, 2353, 3112, 1503, 1063, 2543, 471, 713, 2554, 2588, 2604, 156, 1143, 1235, 1737, 28, 2316, 2631, 3295, 309, 1336, 695, 727, 1836, 2220, 2448, 2449, 2450, 2451, 2452, 430, 455, 3133, 114, 78, 254, 969, 1992, 3220, 1914, 1258, 2221, 777, 334, 582, 1241, 2486, 2037, 3090, 1760, 3114, 75, 1419, 1705, 2466, 2586, 904, 1330, 2369, 385, 201, 582, 136, 1711, 1774, 1010, 110, 472, 541, 1551, 2269, 2332, 427, 1560, 1698, 2114, 2559, 907, 2270, 667, 760, 1079, 1179, 16, 314, 373, 616, 622, 912, 1117, 1567, 1605, 1943, 2416, 2418, 2596, 2637, 2925, 331, 1083, 2948, 87, 2112, 2215, 2918, 1702, 1774, 701, 140, 1653, 1869, 784, 947, 629, 2630, 208, 218, 404, 438, 2433, 2703, 2705, 2589, 659, 1173, 1220, 1393, 1959, 2473, 2670, 2672, 2970, 747, 529, 1198, 1214, 1422, 1617, 1958, 2253, 2542, 715, 773, 2264, 2404, 2868, 1411, 2368, 2790, 1865, 352, 3193, 505, 2345, 2516, 2795, 43, 237, 1275, 1943, 2230, 2443, 2774, 2033, 1123, 1610, 3305, 3306, 61, 2013, 562, 138, 151, 242, 468, 972, 982, 1677, 2243, 672, 1156, 1274, 661, 2638, 643, 2458, 2033, 1610, 37, 371, 1981, 2339, 3071, 2121, 2390, 102, 1349, 581, 3321, 460, 2319, 1616, 582, 999, 170, 2363, 423, 630, 2319, 3030, 347, 416, 464, 1417, 2217, 2253, 2527, 31, 43, 136, 1429, 1625, 1918, 2621, 2622, 2633, 12, 150, 1696, 3114, 1128, 2429, 2565, 1356, 1441, 1535, 533, 978, 1991, 3183, 1189, 1208, 1491, 2168, 104, 541, 1964, 2745, 3274, 1308, 2767, 148, 1319, 2867, 1620, 1778, 254, 1822, 1890, 2067, 2222, 343, 1702, 1711, 1873, 804, 2224, 1771, 3257, 73, 497, 832, 2974, 863, 2659, 269, 441, 2458, 539, 697, 2231, 3205, 2346, 570, 2209, 2251, 812, 621, 1196, 2055, 2819, 3265, 375, 914, 859, 1483, 1821, 886, 637, 2526, 1811, 2847, 1003, 1216, 189, 1044, 2174, 2323, 858, 2458, 1489, 1649, 2804, 2865, 1086, 410, 473, 2202, 3011, 3249, 227, 266, 500, 3249, 901, 1436, 3037, 124, 1292, 1799};
//feature x  3327 3703
#define rows 2000
#define cols  1
int feature[rows*cols]={1, 5, 0, 5, 0, 0, 10, 0, 0, 4, 0, 0, 0, 0, 9, 0, 16, 0, 0, 2, 0, 0, 0, 0, 10, 0, 5, 0, 14, 0, 0, 6, 0, 0, 0, 0, 12, 0, 4, 4, 0, 7, 0, 2, 0, 0, 0, 7, 1, 4, 7, 0, 5, 0, 2, 0, 0, 2, 0, 8, 6, 3, 0, 0, 6, 8, 4, 0, 0, 3, 0, 1, 0, 1, 6, 0, 0, 4, 0, 0, 0, 0, 0, 0, 13, 0, 0, 0, 11, 4, 3, 4, 0, 3, 0, 0, 0, 0, 0, 0, 3, 1, 0, 0, 2, 9, 1, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 12, 4, 0, 0, 0, 0, 13, 0, 1, 0, 0, 4, 0, 3, 0, 1, 7, 0, 0, 0, 0, 1, 9, 0, 0, 9, 0, 1, 0, 3, 0, 0, 0, 12, 0, 3, 0, 0, 0, 9, 5, 7, 1, 2, 12, 0, 0, 0, 11, 0, 6, 0, 0, 2, 1, 0, 1, 6, 4, 0, 0, 0, 0, 2, 0, 4, 3, 2, 0, 3, 0, 0, 0, 0, 0, 0, 0, 2, 1, 0, 0, 0, 0, 4, 0, 5, 0, 0, 0, 0, 0, 0, 8, 0, 1, 17, 0, 4, 0, 9, 0, 0, 0, 0, 6, 0, 0, 0, 0, 2, 0, 0, 0, 2, 4, 0, 0, 0, 0, 1, 0, 3, 0, 0, 3, 0, 0, 8, 7, 0, 0, 0, 0, 0, 3, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 10, 1, 8, 0, 5, 0, 2, 4, 0, 0, 0, 9, 0, 5, 4, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 1, 9, 0, 5, 0, 3, 0, 0, 2, 0, 0, 0, 0, 2, 0, 5, 6, 6, 0, 1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 4, 5, 0, 4, 6, 0, 5, 0, 0, 1, 9, 0, 0, 0, 0, 0, 0, 0, 10, 6, 0, 7, 0, 9, 0, 0, 6, 0, 9, 0, 0, 0, 0, 0, 2, 0, 2, 0, 0, 0, 0, 2, 0, 6, 3, 9, 0, 13, 5, 0, 7, 0, 0, 0, 3, 4, 2, 0, 0, 0, 1, 0, 0, 5, 4, 2, 0, 0, 0, 1, 0, 0, 5, 4, 0, 0, 1, 5, 0, 1, 0, 2, 0, 0, 0, 1, 0, 0, 2, 0, 0, 0, 0, 0, 0, 6, 2, 8, 9, 0, 3, 9, 0, 0, 3, 6, 0, 0, 0, 0, 2, 0, 2, 0, 0, 0, 0, 1, 0, 9, 3, 1, 2, 3, 0, 7, 0, 0, 5, 2, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 7, 4, 0, 0, 7, 4, 0, 0, 6, 0, 5, 1, 12, 5, 0, 0, 0, 0, 0, 6, 0, 0, 2, 11, 0, 3, 0, 0, 0, 0, 2, 16, 2, 7, 8, 0, 0, 7, 3, 0, 0, 1, 8, 11, 0, 0, 0, 0, 9, 0, 4, 0, 0, 0, 0, 0, 2, 0, 0, 7, 0, 0, 6, 5, 0, 0, 6, 0, 0, 0, 0, 0, 0, 3, 2, 0, 3, 0, 0, 8, 0, 2, 3, 6, 7, 0, 4, 0, 6, 0, 2, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 2, 7, 0, 7, 3, 1, 10, 0, 1, 3, 0, 4, 9, 5, 0, 0, 0, 2, 3, 0, 6, 0, 13, 0, 0, 0, 0, 0, 2, 4, 2, 2, 2, 0, 0, 2, 0, 2, 0, 2, 0, 0, 10, 2, 4, 8, 0, 0, 6, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 3, 0, 1, 0, 0, 8, 0, 3, 10, 0, 0, 4, 2, 0, 0, 0, 11, 0, 0, 0, 0, 5, 12, 0, 6, 0, 0, 0, 1, 4, 0, 0, 0, 2, 9, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 1, 4, 0, 0, 1, 5, 0, 0, 0, 0, 0, 3, 1, 3, 0, 0, 9, 0, 4, 2, 0, 0, 1, 12, 0, 2, 0, 4, 0, 0, 0, 2, 0, 0, 0, 0, 0, 2, 6, 9, 2, 6, 0, 3, 1, 0, 8, 0, 0, 13};
int output_data[rows*cols]={0};
#define nnz 505
int val[nnz];


// void read_data() {
//     FILE *file = fopen("/home/rain/benchmark_rh/runahead-mcs/benchmark/output.txt", "r");
//     if (file == NULL) {
//         perror("Failed to open file");
//         return ;
//     }
//     int i = 0, j = 0;
//     //initialize val
//         for(int i=0;i<nnz;i++){
//             val[i] = 1;
//         }

//     //read edge_row
//             for (j = 0; j < Edge_Number; j++) {
//                 if (fscanf(file, "%d", (edge_row+j)) != 1) {
//                     fprintf(stderr, "File read error\n");
//                     return ;
//                 }
//             }
//     //read edge_col
//             for (j = 0; j < Edge_Number; j++) {
//                 if (fscanf(file, "%d", (edge_col+j)) != 1) {
//                     fprintf(stderr, "File read error\n");
//                     return ;
//                 }
//             }
//     // read feature x
//     for (i = 0; i < rows; i++) {
//             for (j = 0; j < cols; j++) {
//                 if (fscanf(file, "%d", &(feature[i*cols+j])) != 1) {
//                     fprintf(stderr, "File read error\n");
//                     return ;
//                 }
//             }
//     }
//         fclose(file);
// }
void print_data(){
        for (int j = 0; j < Edge_Number; j++) {
          printf("%d ",edge_row[j]);
        }
        printf("\n");
        printf("\n");
        printf("\n");
    for (int j = 0; j < Edge_Number; j++) {
          printf("%d ",edge_col[j]);
        }
        printf("\n");
        printf("\n");
        printf("\n");
    for (int j = 0; j < rows*cols; j++) {
          printf("%d ",feature[j]);
        }
        printf("\n");
}


__attribute__((noinline))
void citeseer(){       

  int i = 0;
  int j = 0;
  int temp;
  int X = nnz * cols;
  int x = 0;
  for (x = 0; x < X; ++x) {
    #ifdef CGRA_COMPILER
            please_map_me();
    #endif
    i = x / cols;
    j = x - cols*i;
    temp = val[i] * feature[ edge_col[i]*cols + j ];
      //printf("feature[%d]=%d,%d,%d,%d,val[%d]=%d\n",edge_col[i]*cols + j ,feature[ edge_col[i]*cols + j ],edge_col[i],i,j,i,val[i]);
    output_data[ edge_row[i]*cols + j ] += temp;
       //printf("output_data[%d]=%d temp=%d\n",edge_row[i]*cols+j,output_data[edge_row[i]*cols+j],temp);
  }

}

int main(){

    // read_data();
    // print_data();
        int i = 0, j = 0;
    //initialize val
        for(int i=0;i<nnz;i++){
            val[i] = 1;
        }
    citeseer();
    return 0;
}
